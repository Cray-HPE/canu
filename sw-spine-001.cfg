# The following switch configurations were inserted into the plan-of-record configuration from custom_switch.yaml
# Custom configurations are merged into the generated configuration to maintainsite-specific behaviors and (less frequently) to override known issues.

# interface ethernet 1/16 no switchport force
# interface ethernet 1/16 vrf forwarding Customer
# interface ethernet 1/16 ip address 172.24.253.89/30 primary
# ip route vrf Customer 0.0.0.0/0 172.24.253.90

hostname sw-spine-001
no cli default prefix-modes enable
protocol mlag
protocol bgp
lacp
interface mlag-port-channel 1
interface mlag-port-channel 2
interface mlag-port-channel 3
interface mlag-port-channel 4
interface mlag-port-channel 5
interface mlag-port-channel 7
interface mlag-port-channel 8
interface mlag-port-channel 9
interface mlag-port-channel 10
interface mlag-port-channel 151
interface mlag-port-channel 152
interface ethernet 1/13 speed 40G force
interface ethernet 1/14 speed 40G force
interface ethernet 1/1 speed 40G force
interface ethernet 1/2 speed 40G force
interface ethernet 1/3 speed 40G force
interface ethernet 1/4 speed 40G force
interface ethernet 1/5 speed 40G force
interface ethernet 1/10 speed 40G force
interface ethernet 1/7 speed 40G force
interface ethernet 1/8 speed 40G force
interface ethernet 1/9 speed 40G force
interface ethernet 1/11 speed 10G force
interface ethernet 1/12 speed 10G force
interface ethernet 1/1 mlag-channel-group 1 mode active
interface ethernet 1/2 mlag-channel-group 2 mode active
interface ethernet 1/3 mlag-channel-group 3 mode active
interface ethernet 1/4 mlag-channel-group 4 mode active
interface ethernet 1/5 mlag-channel-group 5 mode active
interface ethernet 1/7 mlag-channel-group 7 mode active
interface ethernet 1/8 mlag-channel-group 8 mode active
interface ethernet 1/9 mlag-channel-group 9 mode active
interface ethernet 1/10 mlag-channel-group 10 mode active
interface ethernet 1/11 mlag-channel-group 151 mode active
interface ethernet 1/12 mlag-channel-group 152 mode active
interface mlag-port-channel 1 switchport mode hybrid
interface mlag-port-channel 2 switchport mode hybrid
interface mlag-port-channel 3 switchport mode hybrid
interface mlag-port-channel 4 switchport mode hybrid
interface mlag-port-channel 5 switchport mode hybrid
interface mlag-port-channel 7 switchport mode hybrid
interface mlag-port-channel 8 switchport mode hybrid
interface mlag-port-channel 9 switchport mode hybrid
interface mlag-port-channel 10 switchport mode hybrid
interface mlag-port-channel 151 switchport mode hybrid
interface mlag-port-channel 152 switchport mode hybrid
interface ethernet 1/1 description "ncn-m001:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/2 description "ncn-m002:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/3 description "ncn-m003:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/4 description "ncn-w001:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/5 description "ncn-w002:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/7 description "ncn-s001:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/8 description "ncn-s002:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/9 description "ncn-s003:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/10 description "ncn-w003:pcie-slot1:1<==sw-spine-001"
interface ethernet 1/11 description "sw-leaf-bmc-001:52<==sw-spine-001"
interface ethernet 1/12 description "sw-leaf-bmc-002:52<==sw-spine-001"
interface ethernet 1/13 description "mlag-isl"
interface ethernet 1/14 description "mlag-isl"
interface mlag-port-channel 1 description "ncn-m001:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 2 description "ncn-m002:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 3 description "ncn-m003:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 4 description "ncn-w001:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 5 description "ncn-w002:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 7 description "ncn-s001:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 8 description "ncn-s002:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 9 description "ncn-s003:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 10 description "ncn-w003:pcie-slot1:1<==sw-spine-001"
interface mlag-port-channel 151 description "sw-leaf-bmc-001:52<==sw-spine-001"
interface mlag-port-channel 152 description "sw-leaf-bmc-002:52<==sw-spine-001"
banner motd "
###############################################################################
# CSM version:  1.3
# CANU version: 1.6.28.post12
###############################################################################
"
ip filter chain input rule append tail target drop dup-delete dest-port 22 in-intf vlan2 protocol tcp
ip filter enable
interface port-channel 256
interface ethernet 1/13 channel-group 256 mode active
interface ethernet 1/14 channel-group 256 mode active
interface port-channel 256 description "mlag-isl"
interface port-channel 256 dcb priority-flow-control mode on force
port-channel load-balance ethernet source-destination-ip ingress-port
interface mlag-port-channel 1 no shutdown
interface ethernet 1/16 ip address 172.24.253.89/30 primary
interface mlag-port-channel 2 no shutdown
interface mlag-port-channel 3 no shutdown
interface mlag-port-channel 4 no shutdown
interface mlag-port-channel 5 no shutdown
interface mlag-port-channel 7 no shutdown
interface mlag-port-channel 8 no shutdown
interface mlag-port-channel 9 no shutdown
interface mlag-port-channel 10 no shutdown
interface mlag-port-channel 151 no shutdown
interface mlag-port-channel 152 no shutdown
interface mlag-port-channel 1 lacp-individual enable force
interface mlag-port-channel 2 lacp-individual enable force
interface mlag-port-channel 3 lacp-individual enable force
interface mlag-port-channel 4 lacp-individual enable force
interface mlag-port-channel 5 lacp-individual enable force
interface mlag-port-channel 7 lacp-individual enable force
interface mlag-port-channel 8 lacp-individual enable force
interface mlag-port-channel 9 lacp-individual enable force
interface mlag-port-channel 10 lacp-individual enable force
vlan 2
vlan 4
vlan 7
vlan 4000
vlan 2 name "RVR_NMN"
vlan 4 name "RVR_HMN"
vlan 7 name "CMN"
vlan 4000 name "MLAG"
vlan 6
vlan 6 name "CAN"
interface mlag-port-channel 1 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 1 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 1 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 1 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 2 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 2 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 2 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 2 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 3 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 3 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 3 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 3 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 4 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 4 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 4 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 4 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 5 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 5 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 5 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 5 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 10 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 10 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 10 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 10 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 7 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 7 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 7 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 7 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 8 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 8 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 8 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 8 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 9 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 9 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 9 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 9 switchport hybrid allowed-vlan add 6
interface mlag-port-channel 151 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 151 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 151 switchport hybrid allowed-vlan add 4
interface mlag-port-channel 152 switchport hybrid allowed-vlan add 7
interface mlag-port-channel 152 switchport hybrid allowed-vlan add 2
interface mlag-port-channel 152 switchport hybrid allowed-vlan add 4
web vrf default enable
vrf definition Customer
vrf definition Customer rd 7:7
ip routing vrf Customer
ip routing vrf default
ip name-server vrf vrf-default 10.92.100.225
no ldap vrf mgmt enable
no radius-server vrf mgmt enable
no snmp-server vrf mgmt enable
no tacacs-server vrf mgmt enable
vrf definition mgmt
interface ethernet 1/16 vrf forwarding Customer
interface loopback 0
interface loopback 0 ip address 10.2.0.2/32 primary
interface vlan 6 vrf forwarding Customer
interface vlan 6 ip address 172.24.76.194/26 primary
no interface vlan 6 ip icmp redirect
interface vlan 6 mtu 9184
interface vlan 1
interface vlan 2
interface vlan 4
interface vlan 7 vrf forwarding Customer
interface vlan 10
interface vlan 4000
interface vlan 1 ip address 10.1.0.2/16 primary
interface vlan 2 ip address 10.252.0.2/17 primary
interface vlan 4 ip address 10.254.0.2/17 primary
interface vlan 7 ip address 172.24.76.130/26 primary
interface vlan 4000 ip address 192.168.255.253/30 primary
no interface vlan 1 ip icmp redirect
interface vlan 1 mtu 9184
no interface vlan 2 ip icmp redirect
interface vlan 2 mtu 9184
no interface vlan 4 ip icmp redirect
interface vlan 4 mtu 9184
no interface vlan 7 ip icmp redirect
interface vlan 7 mtu 9184
interface ethernet 1/16 no switchport force
ip load-sharing source-ip-port
ip load-sharing type consistent
ip route vrf Customer 0.0.0.0/0 172.24.253.90
spanning-tree mode mst
spanning-tree priority 4096
spanning-tree port type edge default
spanning-tree mst name cray
spanning-tree mst revision 2
interface mlag-port-channel 151 spanning-tree port type network
interface mlag-port-channel 151 spanning-tree guard root
interface mlag-port-channel 152 spanning-tree port type network
interface mlag-port-channel 152 spanning-tree guard root
ipv4 access-list nmn-hmn
ipv4 access-list nmn-hmn bind-point rif
ipv4 access-list nmn-hmn seq-number 10 deny ip 10.252.0.0 mask 255.255.128.0 10.254.0.0 mask 255.255.128.0
ipv4 access-list nmn-hmn seq-number 20 deny ip 10.254.0.0 mask 255.255.128.0 10.252.0.0 mask 255.255.128.0
ipv4 access-list nmn-hmn seq-number 30 permit ip any any
ipv4 access-list cmn-can
ipv4 access-list cmn-can bind-point rif
ipv4 access-list cmn-can seq-number 10 deny ip 172.24.76.128 mask 255.255.255.192 172.24.76.192 mask 255.255.255.192
ipv4 access-list cmn-can seq-number 20 deny ip 172.24.76.192 mask 255.255.255.192 172.24.76.128 mask 255.255.255.192
ipv4 access-list cmn-can seq-number 30 permit ip any any
interface vlan 6 ipv4 port access-group cmn-can
interface vlan 2 ipv4 port access-group nmn-hmn
interface vlan 4 ipv4 port access-group nmn-hmn
interface vlan 7 ipv4 port access-group cmn-can
protocol ospf
router ospf 1 vrf default
router ospf 2 vrf Customer
router ospf 1 vrf default router-id 10.2.0.2
router ospf 2 vrf Customer router-id 10.2.0.2
router ospf 2 vrf Customer default-information originate
interface loopback 0 ip ospf area 0.0.0.0
interface vlan 1 ip ospf area 0.0.0.0
interface vlan 2 ip ospf area 0.0.0.0
interface vlan 4 ip ospf area 0.0.0.0
interface vlan 7 ip ospf area 0.0.0.0
interface vlan 6 ip ospf area 0.0.0.0
interface vlan 1 ip ospf passive-interface
interface vlan 4 ip ospf passive-interface
router ospf 1 vrf default redistribute bgp
ip dhcp relay instance 2 vrf default
ip dhcp relay instance 4 vrf default
ip dhcp relay instance 2 address 10.92.100.222
ip dhcp relay instance 4 address 10.94.100.222
interface vlan 1 ip dhcp relay instance 2 downstream
interface vlan 2 ip dhcp relay instance 2 downstream
interface vlan 4 ip dhcp relay instance 4 downstream
protocol magp
interface vlan 1 magp 1
interface vlan 2 magp 2
interface vlan 4 magp 3
interface vlan 7 magp 4
interface vlan 1 magp 1 ip virtual-router address 10.1.0.1
interface vlan 2 magp 2 ip virtual-router address 10.252.0.1
interface vlan 4 magp 3 ip virtual-router address 10.254.0.1
interface vlan 7 magp 4 ip virtual-router address 172.24.76.129
interface vlan 1 magp 1 ip virtual-router mac-address 00:00:5E:00:01:01
interface vlan 2 magp 2 ip virtual-router mac-address 00:00:5E:00:01:02
interface vlan 4 magp 3 ip virtual-router mac-address 00:00:5E:00:01:03
interface vlan 7 magp 4 ip virtual-router mac-address 00:00:5E:00:01:04
interface vlan 6 magp 5
interface vlan 6 magp 5 ip virtual-router address 172.24.76.193
interface vlan 6 magp 5 ip virtual-router mac-address 00:00:5E:00:01:05
mlag-vip mlag-domain ip 192.168.255.242 /29 force
no mlag shutdown
mlag system-mac 00:00:5E:00:01:01
interface port-channel 256 ipl 1
interface vlan 4000 ipl 1 peer-address 192.168.255.254
ip prefix-list pl-cmn
ip prefix-list pl-cmn bulk-mode
ip prefix-list pl-cmn seq 10 permit 172.24.76.128 /26 ge 26
ip prefix-list pl-cmn commit
ip prefix-list pl-can
ip prefix-list pl-can bulk-mode
ip prefix-list pl-can seq 10 permit 172.24.76.192 /26 ge 26
ip prefix-list pl-can commit
ip prefix-list pl-hmn
ip prefix-list pl-hmn bulk-mode
ip prefix-list pl-hmn seq 20 permit 10.94.100.0 /24 ge 24
ip prefix-list pl-hmn commit
ip prefix-list pl-nmn
ip prefix-list pl-nmn bulk-mode
ip prefix-list pl-nmn seq 30 permit 10.92.100.0 /24 ge 24
ip prefix-list pl-nmn commit
route-map ncn-w003-Customer permit 10 match ip address pl-cmn
route-map ncn-w003-Customer permit 20 match ip address pl-can
route-map ncn-w003-Customer permit 20 set ip next-hop 172.24.76.203
route-map ncn-w003 permit 10 match ip address pl-hmn
route-map ncn-w003 permit 10 set ip next-hop 10.254.1.16
route-map ncn-w003 permit 20 match ip address pl-nmn
route-map ncn-w003 permit 20 set ip next-hop 10.252.1.10
route-map ncn-w002-Customer permit 10 match ip address pl-cmn
route-map ncn-w002-Customer permit 20 match ip address pl-can
route-map ncn-w002-Customer permit 20 set ip next-hop 172.24.76.204
route-map ncn-w002 permit 10 match ip address pl-hmn
route-map ncn-w002 permit 10 set ip next-hop 10.254.1.18
route-map ncn-w002 permit 20 match ip address pl-nmn
route-map ncn-w002 permit 20 set ip next-hop 10.252.1.11
route-map ncn-w001-Customer permit 10 match ip address pl-cmn
route-map ncn-w001-Customer permit 20 match ip address pl-can
route-map ncn-w001-Customer permit 20 set ip next-hop 172.24.76.205
route-map ncn-w001 permit 10 match ip address pl-hmn
route-map ncn-w001 permit 10 set ip next-hop 10.254.1.20
route-map ncn-w001 permit 20 match ip address pl-nmn
route-map ncn-w001 permit 20 set ip next-hop 10.252.1.12
router bgp 65533 vrf Customer
router bgp 65533 vrf default
router bgp 65533 vrf Customer router-id 10.2.0.2 force
router bgp 65533 vrf default router-id 10.2.0.2 force
router bgp 65533 vrf Customer distance 20 70 20
router bgp 65533 vrf default distance 20 70 20
router bgp 65533 vrf Customer maximum-paths ibgp 32
router bgp 65533 vrf Customer maximum-paths 32
router bgp 65533 vrf default maximum-paths ibgp 32
router bgp 65533 vrf default maximum-paths 32
router bgp 65533 vrf Customer neighbor 172.24.76.153 remote-as 65532
router bgp 65533 vrf Customer neighbor 172.24.76.154 remote-as 65532
router bgp 65533 vrf Customer neighbor 172.24.76.155 remote-as 65532
router bgp 65533 vrf default neighbor 10.252.1.10 remote-as 65531
router bgp 65533 vrf default neighbor 10.252.1.10 route-map ncn-w003
router bgp 65533 vrf default neighbor 10.252.1.11 remote-as 65531
router bgp 65533 vrf default neighbor 10.252.1.11 route-map ncn-w002
router bgp 65533 vrf default neighbor 10.252.1.12 remote-as 65531
router bgp 65533 vrf default neighbor 10.252.1.12 route-map ncn-w001
router bgp 65533 vrf Customer neighbor 172.24.76.153 timers 1 3
router bgp 65533 vrf Customer neighbor 172.24.76.154 timers 1 3
router bgp 65533 vrf Customer neighbor 172.24.76.155 timers 1 3
router bgp 65533 vrf default neighbor 10.252.1.10 timers 1 3
router bgp 65533 vrf default neighbor 10.252.1.11 timers 1 3
router bgp 65533 vrf default neighbor 10.252.1.12 timers 1 3
router bgp 65533 vrf Customer neighbor 172.24.76.153 transport connection-mode passive
router bgp 65533 vrf Customer neighbor 172.24.76.153 route-map ncn-w003-Customer
router bgp 65533 vrf Customer neighbor 172.24.76.154 transport connection-mode passive
router bgp 65533 vrf Customer neighbor 172.24.76.154 route-map ncn-w002-Customer
router bgp 65533 vrf Customer neighbor 172.24.76.155 transport connection-mode passive
router bgp 65533 vrf Customer neighbor 172.24.76.155 route-map ncn-w001-Customer
router bgp 65533 vrf default neighbor 10.252.1.10 transport connection-mode passive
router bgp 65533 vrf default neighbor 10.252.1.11 transport connection-mode passive
router bgp 65533 vrf default neighbor 10.252.1.12 transport connection-mode passive
no ntp server 10.252.1.12 disable
ntp server 10.252.1.12 keyID 0
no ntp server 10.252.1.12 trusted-enable
ntp server 10.252.1.12 version 4
no ntp server 10.252.1.11 disable
ntp server 10.252.1.11 keyID 0
no ntp server 10.252.1.11 trusted-enable
ntp server 10.252.1.11 version 4
no ntp server 10.252.1.10 disable
ntp server 10.252.1.10 keyID 0
no ntp server 10.252.1.10 trusted-enable
ntp server 10.252.1.10 version 4
ntp vrf default enable