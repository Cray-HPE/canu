hostname {{ hostname }}
user admin group administrators password plaintext {{ password }}
no ip icmp redirect
ntp server {{ ncn-w001 }}
ntp server {{ ncn-w002 }}
ntp server {{ ncn-w003 }}
ntp enable

ssh server vrf default
ssh server vrf mgmt

access-list ip nmn-hmn
    10 deny any {{NMN}} {{HMN}}
    20 deny any {{NMN}} {{MTN_HMN}}
    30 deny any {{HMN}} {{NMN}}
    40 deny any {{HMN}} {{MTN_NMN}}
    50 deny any {{MTN_NMN}} {{HMN}}
    60 deny any {{MTN_NMN}} {{MTN_HMN}}
    70 deny any {{MTN_HMN}} {{NMN}}
    80 deny any {{MTN_HMN}} {{MTN_NMN}}
    90 permit any any any
vlan 1
vlan 2
    name NMN
    apply access-list ip nmn-hmn in
    apply access-list ip nmn-hmn out
vlan 4
    name HMN
    apply access-list ip nmn-hmn in
    apply access-list ip nmn-hmn out
vlan 7
    name CAN

spanning-tree
spanning-tree priority 15
spanning-tree max-age 6
spanning-tree config-name MST0
spanning-tree config-revision 1
interface mgmt
shutdown

{% include 'sw-leaf-bmc-uplink.j2' %}

{% include 'bmc.j2' %}

interface loopback 0
    ip address {{ Loopback_IP }}
    ipv6 address {{ IPV6_IP }}
    ip ospf 1 area 0.0.0.0
    ipv6 ospfv3 1 area 0.0.0.0
interface vlan 1
    ip mtu 9198
    ip address {{ MTL_IP }}
    ipv6 address autoconfig
    ip helper-address 10.92.100.222
    ipv6 ospfv3 1 area 0.0.0.0
    ip igmp enable
interface vlan 2
    description NMN
    ip mtu 9198
    ip address {{ NMN_IP }}
    ip helper-address 10.92.100.222
    ip ospf 1 area 0.0.0.0
    ip igmp enable
interface vlan 4
    description HMN
    ip mtu 9198
    ip address {{ HMN_IP }}
    ip helper-address 10.94.100.222
    ip ospf 1 area 0.0.0.0
    ip igmp enable
snmp-server vrf default
snmpv3 user {{% snmp_user %}} auth md5 auth-pass plaintext {{% snmp_auth %}} priv des priv-pass ciphertext {{ snmp_cipher }}

router ospf 1
    router-id {{ Loopback_IP }}
    area 0.0.0.0
router ospfv3 1
    router-id {{ Loopback_IP }}
    area 0.0.0.0
https-server vrf default
https-server vrf mgmt
