{#- ACL Object groups for services ACL #}
object-group ip address NMN_NCN
{%- set ns = namespace(last_sequence=0) %}
{%- for name, ip in variables.NMN_IPs.items() if name.startswith('ncn-') %}
    {{ loop.index * 10 }} {{ ip }}
{%- set ns.last_sequence = loop.index * 10 %}
{%- endfor %}
object-group ip address MANAGED_NODES
    10 {{ variables.NMN_NETWORK_IP }}/{{ variables.NMN_NETMASK }}
object-group ip address NMN_K8S_API
    10 {{ variables.RGW_VIP }}
    20 {{ variables.KUBEAPI_VIP }}
    30 {{ variables.NMNLB_NETWORK_IP }}/{{ variables.NMNLB_NETMASK }}
object-group ip address TFTP_SERVER
    10 {{ variables.NMNLB_TFTP }}
object-group ip address ISTIO
    10 {{ variables.ISTIO }}
    20 {{ variables.ISTIO_LOCAL }}
object-group ip address CRAY-SPIRE
    10 {{ variables.SPIRE_CLUSTER }}
    20 {{ variables.SPIRE_LOCAL }}
object-group ip address FLUENTBIT_AGGREGATOR
     10 {{ variables.FLUENTBIT_AGGREGATOR }}
object-group port NMN_TCP_SERVICES
    10 eq dns
    20 eq dhcp-server
    30 eq dhcp-client
    40 eq http
    50 eq https
    60 eq syslog
    70 eq 2020
    80 eq 8080
    90 eq 8081
    100 eq 8883
    110 eq 8888
    120 eq 8514
object-group port NMN_UDP_SERVICES
    10 eq dns
    20 eq dhcp-server
    30 eq dhcp-client
    40 eq tftp
    50 eq syslog
    60 eq 8514
    70 eq ntp
{#- end ACL Object groups for services ACL #}
