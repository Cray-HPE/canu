--- # cabling standards
specs:
  version: "1.4"
  hardware_type: "hpe"
definitions:
  - ports: &bmc
      - destination_description: 'HMN Leaf'
        destination_use: "HMN"
        speed: 1
  - ports: &site-bmc
      - destination_description: "Master 001 connection to site, others HMN Leaf (see notes)"
        destination_use: "HMN"
        speed: 1
  - ports: &mlag-cross-card-1
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "Switch pair: switch 1 of 2"
        destination_use: "NONE"
        speed: 25
  - ports: &mlag-cross-card-2
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "Switch pair: switch 2 of 2"
        destination_use: "NONE"
        speed: 25
  - ports: &mlag-same-card
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
  - ports: &master-mlag-cross-card-1
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "Switch pair: switch 1 of 2"
        destination_use: "Manager 001 to site, otherwise NONE (see notes)"
        speed: 25
  - ports: &master-mlag-cross-card-2
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "Switch pair: switch 2 of 2"
        destination_use: "NONE"
        speed: 25
  - ports: &worker-mlag-cross-card-1
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "NONE"
        destination_use: "NONE"
        speed: 25
  - ports: &worker-mlag-cross-card-2
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "NONE"
        destination_use: "NONE"
        speed: 25
  - ports: &storage-mlag-cross-card-1
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "SUN (cabled but not configured)"
        speed: 25
  - ports: &storage-mlag-cross-card-2
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "HMN, NMN, CAN (e.g. bond0)"
        speed: 25
      - destination_description: "MLAG switch pair: switch 2 of 2"
        destination_use: "SUN (cabled but not configured)"
        speed: 25
  - ports: &uan-cross-card-1
      - destination_description: "switch pair: switch 1 of 2"
        destination_use: "NMN"
        speed: 25
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "CAN"
        speed: 25
  - ports: &uan-cross-card-2
      - destination_description: "switch pair: switch 1 of 2"
        destination_use: "NONE"
        speed: 25
      - destination_description: "MLAG switch pair: switch 1 of 2"
        destination_use: "CAN"
        speed: 25
  - ports: &mountain-static-lag
      - destination_description: "Static LAG: CDU switch 1 of 2"
        destination_use: "Per cabinet NMN and HMN"
        speed: 10
      - destination_description: "Static LAG: CDU switch 2 of 2"
        destination_use: "Per cabinet NMN and HMN"
        speed: 10
nodes:
  - type: "ncn"
    subtype: "master"
    devices:
      - name: "ocp"
        ports: *master-mlag-cross-card-1
      - name: "pcie-slot1"
        ports: *master-mlag-cross-card-2
      - name: "ilo"
        ports: *site-bmc
    notes:
      - "REQUIRED:  Master 001 (ncn-m001) is required to have a site connection on OCP Port 2 for installation and maintenance."
      - "RECOMMENDED: Masters 002 and 003 may optionally have a site connection on OCP Port 2 for emergency system access."
      - "REQUIRED:  Master 001 (ncn-m001) is required to have it's BMC/iLO connected to the site."
  - type: "ncn"
    subtype: "worker"
    devices:
      - name: "ocp"
        ports: *mlag-same-card
      - name: "ilo"
        ports: *bmc
    notes:
      - "A single OCP card is the default worker configuration."
  - type: "ncn"
    subtype: "worker_two_card_(option)"
    devices:
      - name: "ocp"
        ports: *worker-mlag-cross-card-1
      - name: "pcie-slot1"
        ports: *worker-mlag-cross-card-2
      - name: "ilo"
        ports: *bmc
    notes:
      - "A single OCP card and a second PCIE card in Slot 1 is an optional worker configuration when more resiliency is desired."
  - type: "ncn"
    subtype: "storage"
    devices:
      - name: "ocp"
        ports: *storage-mlag-cross-card-1
      - name: "pcie-slot1"
        ports: *storage-mlag-cross-card-2
      - name: "ilo"
        ports: *bmc
    notes:
      - "All ports are cabled."
      - "OCP Port 1 and PCIE Slot 1 Port 1 (first ports) are bonded for the NMN, HMN and CAN."
      - "OCP Port 2 and PCIE Slot 1 Port 2 (second ports) cabled but not configured in this release."
  - type: "application"
    subtype: "uan"
    devices:
      - name: "ocp"
        ports: *uan-cross-card-1
      - name: "pcie-slot1"
        ports: *uan-cross-card-2
      - name: "ilo"
        ports: *bmc
    notes:
      - "All ports are cabled."
      - "The OCP Port 1 connects to the NMN in a non-bonded configuration."
      - "The PCIE Slot 1 Port 1 is cabled but not configured/used in this release."
      - "OCP Port 2 and PCIE Slot 1 Port 2 (second ports) are bonded for the CAN."
  - type: "application"
    subtype: "login"
    devices:
      - name: "ocp"
        ports: *mlag-same-card
      - name: "ilo"
        ports: *bmc
  - type: "mountain"
    subtype: "cmm"
    devices:
      - name: "cmm"
        ports: *mountain-static-lag
  - type: "mountain"
    subtype: "cec"
    devices:
      - name: "cec"
        ports:
          - destination_description: "CDU switch access port"
            destination_use: "per cabinet HMN?"
            speed: 0.1
